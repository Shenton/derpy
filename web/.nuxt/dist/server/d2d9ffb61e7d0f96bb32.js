exports.ids=[3],exports.modules={38:function(e,t,r){"use strict";r.r(t);var o={name:"Membres",fetch:({store:e,redirect:t})=>e.state.auth.isAuth&&e.state.auth.isOwner?void 0:t("/"),head(){return{titleTemplate:"%s - "+this.title}},data:()=>({title:"Administration: Membres",members:[],fields:[{key:"fullName",label:"Membre",sortable:!0,thStyle:{width:"80%"}},{key:"accessCheckBox",label:"Accès",sortable:!0,thStyle:{width:"20%"}}],totalRows:1,currentPage:1,perPage:10,pageOptions:[5,10,15]}),async asyncData({$axios:e}){try{return{members:(await e.$get("members")).map(e=>({...e,key:`${e._id}/${e.revision}`}))}}catch(e){}},mounted(){this.$store.dispatch("breadcrumbs/setCrumbs",this.$route.path),this.totalRows=this.members.length},methods:{async submitUpdate(e,data){try{if(0===(await this.$axios({method:"patch",data:data,url:"members/"+e})).data.modifed)this.$toast.warning("Aucune modification");else{this.$toast.success("Membre modifié");try{const data=await this.$axios.$get("members");this.members=data.map(e=>({...e,key:`${e._id}/${e.revision}`})),this.totalRows=this.members.length}catch(e){this.$axiosGetErrorHandler(e)}}}catch(e){this.axiosPostError(e,"Erreur avec l'édition du membre")}},axiosPostError(e,t){this.$axiosPostErrorHandler(e,"Activité non trouvée","Cette activité existe déjà",t)},toggleAccess(e,t){t?this.submitUpdate(e,{hasAccess:!1}):this.submitUpdate(e,{hasAccess:!0})}}},c=r(1),component=Object(c.a)(o,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("b-jumbotron",{staticClass:"mt-3 mb-3 pt-4 pb-4",attrs:{fluid:"","bg-variant":"dark","text-variant":"light",header:"Administration: Membres",lead:"L'administration des membres."}}),e._ssrNode(" "),r("b-container",[r("b-breadcrumb",{attrs:{items:e.$store.state.breadcrumbs.crumbs}})],1),e._ssrNode(" "),e.members.length?r("b-container",{staticClass:"pb-5"},[r("b-table",{attrs:{hover:"","head-variant":"light","current-page":e.currentPage,"per-page":e.perPage,items:e.members,fields:e.fields},scopedSlots:e._u([{key:"fullName",fn:function(t){return[e._v("\r\n                "+e._s(t.item.username)),r("span",{staticClass:"text-primary"},[e._v("#"+e._s(t.item.discriminator))]),e._v(e._s(t.item.isOwner?"  (Owner)":"")+"\r\n            ")]}},{key:"accessCheckBox",fn:function(t){return[r("b-form",[r("b-form-checkbox",{attrs:{name:"check-button",switch:""},on:{change:function(r){return e.toggleAccess(t.item._id,t.item.hasAccess)}},model:{value:t.item.hasAccess,callback:function(r){e.$set(t.item,"hasAccess",r)},expression:"row.item.hasAccess"}})],1)]}}],null,!1,450159306)}),e._v(" "),r("b-row",[r("b-col",[r("b-pagination",{staticClass:"my-0",attrs:{"total-rows":e.totalRows,"per-page":e.perPage},model:{value:e.currentPage,callback:function(t){e.currentPage=t},expression:"currentPage"}})],1),e._v(" "),r("b-col",[r("b-form-group",{staticClass:"mb-0",attrs:{"label-cols-sm":"3",label:"Nombre par page"}},[r("b-form-select",{attrs:{options:e.pageOptions},model:{value:e.perPage,callback:function(t){e.perPage=t},expression:"perPage"}})],1)],1)],1)],1):e._e()],2)},[],!1,null,null,"615b19c7");t.default=component.exports}};
//# sourceMappingURL=d2d9ffb61e7d0f96bb32.js.map